# AI ãŠã¿ãã˜ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ ğŸ´âœ¨

AWS Bedrock AgentCore Runtime + Strands Agents ã‚’ä½¿ã£ãŸAIå ã„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

## æ¦‚è¦

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãŠã¿ãã˜ã‚’å¼•ãã¨ã€AIãŒé‹å‹¢ã‚’å ã„ã€ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚®ãƒ£ãƒ«èªé¢¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ãƒ©ãƒƒã‚­ãƒ¼ã‚¢ã‚¤ãƒ†ãƒ ã‚„ã‚¹ãƒãƒƒãƒˆã‚’ãŠçŸ¥ã‚‰ã›ã—ã¾ã™ã€‚**Strands Agents + AgentCore Memory** ã«ã‚ˆã‚Šã€ãŠã¿ãã˜çµæœã«ã¤ã„ã¦ãƒãƒ£ãƒƒãƒˆã§ä¼šè©±ã§ãã¾ã™ã€‚

## ğŸŒŸ ãƒ©ã‚¤ãƒ–ãƒ‡ãƒ¢

**æœ¬ç•ªã‚µã‚¤ãƒˆ**: https://main.d41aq4729k4l7.amplifyapp.com

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### Strands Agents + AgentCore Memory çµ±åˆæ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              AWS Cloud (ap-northeast-1)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                       Amplify Hosting                                 â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚  â”‚
â”‚  â”‚  â”‚    Next.js SSR   â”‚     â”‚   API Routes     â”‚                       â”‚  â”‚
â”‚  â”‚  â”‚    Frontend      â”‚â”€â”€â”€â”€â–¶â”‚  /api/omikuji    â”‚                       â”‚  â”‚
â”‚  â”‚  â”‚                  â”‚     â”‚  /api/chat       â”‚                       â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚  â”‚
â”‚  â”‚                                    â”‚                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                       â”‚ InvokeAgentRuntime                  â”‚
â”‚                                       â”‚ (AWS SDK v3)                        â”‚
â”‚                                       â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    AgentCore Runtime (ECR)                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚                    omikuji_agent.py                             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚              Strands Agent                                â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ AgentCore       â”‚    â”‚   Bedrock Claude            â”‚  â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ Memory Config   â”‚â”€â”€â”€â–¶â”‚   (Haiku / Sonnet)          â”‚  â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                 â”‚    â”‚   ã‚®ãƒ£ãƒ«èªç”Ÿæˆ               â”‚  â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚           â”‚                                               â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚           â–¼                                               â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚     AgentCoreMemorySessionManager                   â”‚  â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚     (ä¼šè©±å±¥æ­´ã®è‡ªå‹•ç®¡ç†)                             â”‚  â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                    â”‚                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                       â”‚                                     â”‚
â”‚                                       â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    AgentCore Memory (STM)                             â”‚  â”‚
â”‚  â”‚                    ID: my_agent_mem-W3DiyUCFmg                        â”‚  â”‚
â”‚  â”‚                    - ä¼šè©±å±¥æ­´ã®æ°¸ç¶šåŒ–                                  â”‚  â”‚
â”‚  â”‚                    - ã‚»ãƒƒã‚·ãƒ§ãƒ³å˜ä½ã§ç®¡ç†                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ãŠã¿ãã˜ â†’ ãƒãƒ£ãƒƒãƒˆ ãƒ•ãƒ­ãƒ¼                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  1ï¸âƒ£ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãŠã¿ãã˜ã‚’å¼•ã                                            â”‚
â”‚     â””â”€â†’ æ–°ã—ã„ session_id ã‚’ç™ºè¡Œï¼ˆä¾‹: omikuji-20251225-abc123ï¼‰        â”‚
â”‚     â””â”€â†’ ãŠã¿ãã˜çµæœã€Œä¸­å‰ã€ã‚’å–å¾—                                      â”‚
â”‚     â””â”€â†’ AgentCore Memory ã«çµæœã‚’è¨˜éŒ²                                   â”‚
â”‚                                                                         â”‚
â”‚  2ï¸âƒ£ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒãƒ£ãƒƒãƒˆã§è³ªå•                                            â”‚
â”‚     â””â”€â†’ ã€Œä¸­å‰ã£ã¦ã©ã†ãªã®ï¼Ÿã€                                         â”‚
â”‚     â””â”€â†’ åŒã˜ session_id ã‚’ä½¿ç”¨                                         â”‚
â”‚     â””â”€â†’ Agent ãŒ Memory ã‹ã‚‰ã€Œä¸­å‰ã€ã®çµæœã‚’å‚ç…§ã—ã¦å›ç­”                â”‚
â”‚                                                                         â”‚
â”‚  3ï¸âƒ£ ã‚‚ã†ä¸€åº¦ãŠã¿ãã˜ã‚’å¼•ã                                              â”‚
â”‚     â””â”€â†’ æ–°ã—ã„ session_id ã‚’ç™ºè¡Œï¼ˆä¾‹: omikuji-20251225-def456ï¼‰        â”‚
â”‚     â””â”€â†’ å‰ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯ãƒªã‚»ãƒƒãƒˆã€æ–°ã—ã„çµæœã§ä¼šè©±é–‹å§‹                  â”‚
â”‚                                                                         â”‚
â”‚  ğŸ’¡ ãƒã‚¤ãƒ³ãƒˆ: ãŠã¿ãã˜ID = session_id = ãƒãƒ£ãƒƒãƒˆID                      â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§  Strands Agents ã¨ã¯

**Strands Agents** ã¯ã€AWS ãŒ 2025å¹´ã® re:Invent ã§ç™ºè¡¨ã—ãŸã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ AI ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚

### ç‰¹å¾´

| ç‰¹å¾´ | èª¬æ˜ |
|------|------|
| **LLM é§†å‹•** | ãƒ¢ãƒ‡ãƒ«ã®æ¨è«–èƒ½åŠ›ã§ã‚¿ã‚¹ã‚¯ã‚’è¨ˆç”»ãƒ»å®Ÿè¡Œ |
| **AWS çµ±åˆ** | Bedrock, EKS, Lambda, EC2 ã¨ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹é€£æº |
| **Memory ç®¡ç†** | AgentCore Memory ã¨ã®çµ±åˆã§ä¼šè©±å±¥æ­´ã‚’æ°¸ç¶šåŒ– |
| **ãƒ„ãƒ¼ãƒ«ç™»éŒ²** | Code Interpreter, RAG, ã‚«ã‚¹ã‚¿ãƒ ãƒ„ãƒ¼ãƒ«å¯¾å¿œ |
| **ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ** | Handoffs, Swarms, Graph ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ |

### Strands vs ä»–ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯

| ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ | ç‰¹å¾´ | AWSçµ±åˆ |
|---------------|------|---------|
| **Strands** | AWSå…¬å¼ã€AgentCoreçµ±åˆ | â­â­â­ |
| LangChain | æ±ç”¨çš„ã€ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ è±Šå¯Œ | â­â­ |
| CrewAI | ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆç‰¹åŒ– | â­ |

### Strands + AgentCore Memory çµ±åˆ

```python
from bedrock_agentcore.memory.integrations.strands.config import AgentCoreMemoryConfig
from bedrock_agentcore.memory.integrations.strands.session_manager import AgentCoreMemorySessionManager
from strands import Agent

# Memoryè¨­å®š
config = AgentCoreMemoryConfig(
    memory_id="my_agent_mem-W3DiyUCFmg",  # AgentCore Memory ID
    session_id=session_id,                 # ãŠã¿ãã˜IDï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ï¼‰
    actor_id=actor_id                      # ãƒ¦ãƒ¼ã‚¶ãƒ¼è­˜åˆ¥å­
)

# ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ä½œæˆ
session_manager = AgentCoreMemorySessionManager(
    agentcore_memory_config=config,
    region_name="ap-northeast-1"
)

# Strands Agentä½œæˆï¼ˆMemoryçµ±åˆæ¸ˆã¿ï¼ï¼‰
agent = Agent(
    system_prompt="ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚®ãƒ£ãƒ«èªã§è©±ã™ãŠã¿ãã˜AIã§ã™",
    session_manager=session_manager  # â† ã“ã‚ŒãŒã‚­ãƒ¼ï¼
)

# ä¼šè©±ã¯è‡ªå‹•çš„ã« Memory ã«ä¿å­˜ã•ã‚Œã‚‹
response = agent("ãŠã¿ãã˜ã‚’å¼•ã„ã¦ï¼")
```

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆAgentCore Runtimeï¼‰

| æŠ€è¡“ | ç”¨é€” | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ |
|------|------|-----------|
| Amazon Bedrock AgentCore Runtime | AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆåŸºç›¤ | 2025.12 |
| **Strands Agents SDK** | ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ | Latest |
| **AgentCoreMemorySessionManager** | ä¼šè©±å±¥æ­´ç®¡ç† | bedrock-agentcore[strands-agents] |
| AWS Bedrock Claude | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”Ÿæˆ | Haiku 3 / Sonnet 4 |
| Python | ãƒ©ãƒ³ã‚¿ã‚¤ãƒ  | 3.11 |

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

| æŠ€è¡“ | ç”¨é€” | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ |
|------|------|-----------|
| Next.js | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ | 14.x |
| AWS Amplify Hosting | ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚° | Latest |
| TailwindCSS | ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚° | 3.x |
| TypeScript | å‹å®‰å…¨ | 5.x |

### ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£

| æŠ€è¡“ | ç”¨é€” | IaC |
|------|------|-----|
| AWS Amplify Hosting | ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒ»CI/CD | Amplify Console |
| Amazon ECR | ã‚³ãƒ³ãƒ†ãƒŠãƒ¬ã‚¸ã‚¹ãƒˆãƒª | - |
| AWS CodeBuild | ARM64ã‚³ãƒ³ãƒ†ãƒŠãƒ“ãƒ«ãƒ‰ | **CloudFormation** âœ… |
| AgentCore Memory | ä¼šè©±å±¥æ­´ (STM) | - |
| CloudWatch Logs | ãƒ­ã‚°ç›£è¦– | - |

### ã‚¤ãƒ³ãƒ•ãƒ©ã‚³ãƒ¼ãƒ‰ (IaC)

```
infra/
â”œâ”€â”€ codebuild.yml           # CodeBuild ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®šç¾©
â”‚   â”œâ”€â”€ GitHub é€£æºè¨­å®š
â”‚   â”œâ”€â”€ ARM64 ãƒ“ãƒ«ãƒ‰ç’°å¢ƒ
â”‚   â””â”€â”€ ECR ãƒ—ãƒƒã‚·ãƒ¥è¨­å®š
â”‚
â””â”€â”€ deploy-codebuild.sh     # ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
    â”œâ”€â”€ create  - ã‚¹ã‚¿ãƒƒã‚¯ä½œæˆ
    â”œâ”€â”€ update  - ã‚¹ã‚¿ãƒƒã‚¯æ›´æ–°
    â”œâ”€â”€ delete  - ã‚¹ã‚¿ãƒƒã‚¯å‰Šé™¤
    â””â”€â”€ status  - ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª
```

### CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           CI/CD ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã€‘ Next.js                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  GitHub (main)  â”€â”€pushâ”€â”€â–¶  Amplify Hosting (è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤)           â”‚   â”‚
â”‚  â”‚                            - ãƒ“ãƒ«ãƒ‰ & ãƒ‡ãƒ—ãƒ­ã‚¤ è‡ªå‹•å®Ÿè¡Œ              â”‚   â”‚
â”‚  â”‚                            - SSRå¯¾å¿œ                                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã€‘ AgentCore Runtime                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  GitHub (main)  â”€â”€æ‰‹å‹•ãƒˆãƒªã‚¬ãƒ¼â”€â”€â–¶  CodeBuild (ARM64)                â”‚   â”‚
â”‚  â”‚                                      â”‚                              â”‚   â”‚
â”‚  â”‚                                      â–¼                              â”‚   â”‚
â”‚  â”‚                                  ECR (ã‚³ãƒ³ãƒ†ãƒŠ)                      â”‚   â”‚
â”‚  â”‚                                      â”‚                              â”‚   â”‚
â”‚  â”‚                                      â–¼                              â”‚   â”‚
â”‚  â”‚                              AgentCore Runtime (æ‰‹å‹•æ›´æ–°)            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  ğŸ“ CodeBuild ã¯ GitHub ãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰ç›´æ¥ã‚½ãƒ¼ã‚¹ã‚’å–å¾—                       â”‚
â”‚     ï¼ˆS3çµŒç”±ã®ZIPã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸è¦ï¼‰                                          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
omikuji-agent/
â”œâ”€â”€ README.md                     # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ requirements.txt              # Pythonä¾å­˜é–¢ä¿‚
â”œâ”€â”€ Dockerfile                    # ARM64ã‚³ãƒ³ãƒ†ãƒŠå®šç¾©
â”œâ”€â”€ buildspec.yml                 # CodeBuildè¨­å®š
â”‚
â”œâ”€â”€ omikuji_agent.py              # AgentCore Runtime ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ â­
â”‚   â”œâ”€â”€ Strands Agent åˆæœŸåŒ–
â”‚   â”œâ”€â”€ AgentCoreMemorySessionManager çµ±åˆ
â”‚   â””â”€â”€ ãŠã¿ãã˜ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯
â”‚
â”œâ”€â”€ infra/                        # ã‚¤ãƒ³ãƒ•ãƒ©ã‚³ãƒ¼ãƒ‰ (IaC) â­
â”‚   â”œâ”€â”€ codebuild.yml             # CodeBuild CloudFormation ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”‚   â””â”€â”€ deploy-codebuild.sh       # ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚
â””â”€â”€ nextjs-app/                   # Amplify Hosting ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
    â”œâ”€â”€ app/
    â”‚   â”œâ”€â”€ api/
    â”‚   â”‚   â”œâ”€â”€ omikuji/route.ts  # ãŠã¿ãã˜API
    â”‚   â”‚   â””â”€â”€ chat/route.ts     # ãƒãƒ£ãƒƒãƒˆAPI
    â”‚   â”œâ”€â”€ page.tsx              # ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
    â”‚   â””â”€â”€ layout.tsx            # ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
    â”œâ”€â”€ lib/
    â”‚   â””â”€â”€ api.ts                # API ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ï¼‰
    â”œâ”€â”€ package.json
    â””â”€â”€ tailwind.config.ts
```

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶

- AWS ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆBedrock Claude ãƒ¢ãƒ‡ãƒ«ã‚¢ã‚¯ã‚»ã‚¹æœ‰åŠ¹åŒ–æ¸ˆã¿ï¼‰
- AWS CLI v2 è¨­å®šæ¸ˆã¿
- Node.js 18+
- Python 3.11+
- Dockerï¼ˆARM64ãƒ“ãƒ«ãƒ‰ç”¨ï¼‰
- GitHub OAuth é€£æºè¨­å®šæ¸ˆã¿ï¼ˆCodeBuildç”¨ï¼‰

### Step 0: ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã®ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆåˆå›ã®ã¿ï¼‰

CodeBuild ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ CloudFormation ã§ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚

```bash
# CloudFormation ã‚¹ã‚¿ãƒƒã‚¯ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤
./infra/deploy-codebuild.sh create

# ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª
./infra/deploy-codebuild.sh status
```

**æ³¨æ„**: æ—¢å­˜ã® CodeBuild ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒã‚ã‚‹å ´åˆã¯ `update` ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

### Step 1: AgentCore Memory ä½œæˆï¼ˆåˆå›ã®ã¿ï¼‰

```bash
# AgentCore Memory ã‚’ä½œæˆ
aws bedrock-agentcore-control create-memory \
  --name "omikuji_agent_mem" \
  --description "Memory for omikuji agent with STM" \
  --region ap-northeast-1
```

### Step 2: AgentCore Runtime ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install bedrock-agentcore strands-agents

# ECRã«ã‚³ãƒ³ãƒ†ãƒŠã‚’ãƒ—ãƒƒã‚·ãƒ¥ï¼ˆCodeBuildçµŒç”±ï¼‰
aws codebuild start-build --project-name bedrock-agentcore-my_agent-builder

# AgentCore Runtime ä½œæˆ
aws bedrock-agentcore-control create-agent-runtime \
  --agent-runtime-name omikuji_agent \
  --agent-runtime-artifact containerUri=<ECR_URI>:latest \
  --role-arn <IAM_ROLE_ARN> \
  --network-configuration networkMode=PUBLIC \
  --environment-variables BEDROCK_AGENTCORE_MEMORY_ID=<MEMORY_ID>
```

### Step 3: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
cd nextjs-app
npm install
git push origin main  # Amplifyè‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
```

## ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †ï¼ˆè©³ç´°ï¼‰

### AgentCore Runtime æ›´æ–°ãƒ‡ãƒ—ãƒ­ã‚¤

`omikuji_agent.py` ã‚’å¤‰æ›´ã—ãŸå ´åˆã®å†ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †ã§ã™ã€‚

**CodeBuild ã¯ GitHub ãƒªãƒã‚¸ãƒˆãƒªã¨é€£æºæ¸ˆã¿**ã®ãŸã‚ã€mainãƒ–ãƒ©ãƒ³ãƒã®ã‚³ãƒ¼ãƒ‰ã‹ã‚‰ç›´æ¥ãƒ“ãƒ«ãƒ‰ã•ã‚Œã¾ã™ã€‚

#### Step 1: ã‚³ãƒ¼ãƒ‰ã‚’ main ã«ãƒãƒ¼ã‚¸

```bash
# feature ãƒ–ãƒ©ãƒ³ãƒã§ä½œæ¥­
git checkout -b feature/your-feature
# ... ã‚³ãƒ¼ãƒ‰å¤‰æ›´ ...
git add -A && git commit -m "feat: your changes"
git push -u origin feature/your-feature

# PRä½œæˆ â†’ ãƒ¬ãƒ“ãƒ¥ãƒ¼ â†’ main ã«ãƒãƒ¼ã‚¸
gh pr create --base main --title "your PR title"
```

#### Step 2: CodeBuild ã§ARM64ã‚³ãƒ³ãƒ†ãƒŠã‚’ãƒ“ãƒ«ãƒ‰

```bash
# CodeBuildãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å®Ÿè¡Œï¼ˆGitHubã®mainãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰è‡ªå‹•å–å¾—ï¼‰
aws codebuild start-build --project-name bedrock-agentcore-my_agent-builder

# ãƒ“ãƒ«ãƒ‰çŠ¶æ³ã‚’ç¢ºèª
aws codebuild batch-get-builds --ids <BUILD_ID> --query 'builds[0].{status:buildStatus,phase:currentPhase}'
```

**ğŸ“ ãƒ“ãƒ«ãƒ‰ãƒˆãƒªã‚¬ãƒ¼å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«:**
- `omikuji_agent.py` - ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãƒ­ã‚¸ãƒƒã‚¯
- `Dockerfile` - ã‚³ãƒ³ãƒ†ãƒŠå®šç¾©
- `requirements.txt` - Pythonä¾å­˜é–¢ä¿‚
- `buildspec.yml` - ãƒ“ãƒ«ãƒ‰è¨­å®š

**âš ï¸ æ³¨æ„: Docker Hub Rate Limit**

Docker Hub ã® pull rate limit ã«å¼•ã£ã‹ã‹ã‚‹å ´åˆã¯ã€Dockerfile ã®ãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ ECR Public ã«å¤‰æ›´ã—ã¦ãã ã•ã„ï¼š

```dockerfile
# NG: Docker Hubï¼ˆrate limitã‚ã‚Šï¼‰
FROM --platform=linux/arm64 python:3.11-slim

# OK: ECR Publicï¼ˆrate limitãªã—ï¼‰
FROM --platform=linux/arm64 public.ecr.aws/docker/library/python:3.11-slim
```

#### Step 3: AgentCore Runtime ã‚’æ›´æ–°

```bash
# ç¾åœ¨ã®ãƒ­ãƒ¼ãƒ«ARNã‚’ç¢ºèªï¼ˆåˆå›ã®ã¿ï¼‰
aws bedrock-agentcore-control get-agent-runtime \
  --agent-runtime-id omikuji_agent-JkUdnzGA2D \
  --query 'roleArn' --output text

# æœ€æ–°ã‚¤ãƒ¡ãƒ¼ã‚¸ã§Runtimeã‚’æ›´æ–°
aws bedrock-agentcore-control update-agent-runtime \
  --agent-runtime-id omikuji_agent-JkUdnzGA2D \
  --agent-runtime-artifact 'containerConfiguration={containerUri=<ACCOUNT_ID>.dkr.ecr.ap-northeast-1.amazonaws.com/bedrock-agentcore-my_agent:latest}' \
  --network-configuration networkMode=PUBLIC \
  --role-arn <ROLE_ARN>

# æ›´æ–°çŠ¶æ³ã‚’ç¢ºèª
aws bedrock-agentcore-control get-agent-runtime \
  --agent-runtime-id omikuji_agent-JkUdnzGA2D \
  --query '{status:status,version:agentRuntimeVersion}'
```

ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒ `READY` ã«ãªã‚‹ã¾ã§å¾…ã¡ã¾ã™ï¼ˆç´„1-2åˆ†ï¼‰ã€‚

#### Step 4: å‹•ä½œç¢ºèª

```bash
# ãƒ†ã‚¹ãƒˆå‘¼ã³å‡ºã—ï¼ˆbase64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãŒå¿…è¦ï¼‰
PAYLOAD=$(echo '{"prompt": "test", "session_id": "test-session-12345678901234567890123456", "actor_id": "test_user", "action": "draw"}' | base64 -w 0)

aws bedrock-agentcore invoke-agent-runtime \
  --agent-runtime-arn arn:aws:bedrock-agentcore:ap-northeast-1:<ACCOUNT_ID>:runtime/omikuji_agent-JkUdnzGA2D \
  --runtime-session-id "test-session-12345678901234567890123456" \
  --payload "$PAYLOAD" \
  /tmp/response.json

cat /tmp/response.json
```

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆAmplifyï¼‰ãƒ‡ãƒ—ãƒ­ã‚¤

Next.js ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¯ GitHub ã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã§è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¾ã™ã€‚

```bash
# å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ
git add -A
git commit -m "feat: your changes"

# mainã«ãƒ—ãƒƒã‚·ãƒ¥ï¼ˆAmplifyè‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ï¼‰
git push origin main

# ãƒ‡ãƒ—ãƒ­ã‚¤çŠ¶æ³ã‚’ç¢ºèª
aws amplify list-jobs --app-id d41aq4729k4l7 --branch-name main --max-items 1
```

### ãƒ‡ãƒ—ãƒ­ã‚¤ç¢ºèªãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

| ç¢ºèªé …ç›® | ã‚³ãƒãƒ³ãƒ‰ |
|---------|---------|
| CodeBuild ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | `aws codebuild batch-get-builds --ids <BUILD_ID> --query 'builds[0].buildStatus'` |
| ECR ã‚¤ãƒ¡ãƒ¼ã‚¸ç¢ºèª | `aws ecr describe-images --repository-name bedrock-agentcore-my_agent --query 'imageDetails[0].imageTags'` |
| Runtime ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ | `aws bedrock-agentcore-control get-agent-runtime --agent-runtime-id omikuji_agent-JkUdnzGA2D --query 'status'` |
| Amplify ãƒ‡ãƒ—ãƒ­ã‚¤ | `aws amplify list-jobs --app-id d41aq4729k4l7 --branch-name main --max-items 1 --query 'jobSummaries[0].status'` |
| CloudWatch ãƒ­ã‚° | `aws logs filter-log-events --log-group-name /aws/bedrock-agentcore/runtime/omikuji_agent-JkUdnzGA2D --limit 10` |

### ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

#### ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚¨ãƒ©ãƒ¼

```
ValidationException: Value at 'runtimeSessionId' failed to satisfy constraint: 
Member must have length greater than or equal to 33
```

**åŸå› **: ã‚»ãƒƒã‚·ãƒ§ãƒ³IDãŒ33æ–‡å­—æœªæº€

**è§£æ±º**: `lib/api.ts` ã® `generateNewSessionId()` ã§36æ–‡å­—ä»¥ä¸Šã®IDã‚’ç”Ÿæˆã™ã‚‹ã‚ˆã†ã«ä¿®æ­£

```typescript
// 36æ–‡å­—ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³IDç”Ÿæˆ
export function generateNewSessionId(): string {
  const timestamp = new Date().toISOString().replace(/[-:T.Z]/g, '').slice(0, 14);
  const uuid = crypto.randomUUID();
  const randomParts = uuid.split('-').slice(0, 2).join('-');
  return `omikuji-${timestamp}-${randomParts}`;
}
```

#### Docker Hub Rate Limit

```
error pulling image: 429 Too Many Requests
```

**åŸå› **: Docker Hub ã® anonymous pull åˆ¶é™

**è§£æ±º**: Dockerfile ã§ ECR Public ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½¿ç”¨

```dockerfile
FROM --platform=linux/arm64 public.ecr.aws/docker/library/python:3.11-slim
```

#### AgentCore Runtime æ›´æ–°ã‚¨ãƒ©ãƒ¼

```
Unknown parameter 'containerUri' in agentRuntimeArtifact
```

**è§£æ±º**: æ­£ã—ã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å½¢å¼ã‚’ä½¿ç”¨

```bash
# NG
--agent-runtime-artifact containerUri=xxx

# OK
--agent-runtime-artifact 'containerConfiguration={containerUri=xxx}'
```

#### AgentCore Runtime æ›´æ–°æ™‚ã« role-arn ã‚¨ãƒ©ãƒ¼

```
the following arguments are required: --role-arn
```

**åŸå› **: `update-agent-runtime` ã‚³ãƒãƒ³ãƒ‰ã«ã¯ `--role-arn` ãŒå¿…é ˆ

**è§£æ±º**: ç¾åœ¨ã®ãƒ­ãƒ¼ãƒ«ARNã‚’å–å¾—ã—ã¦æŒ‡å®š

```bash
# ãƒ­ãƒ¼ãƒ«ARNç¢ºèª
aws bedrock-agentcore-control get-agent-runtime \
  --agent-runtime-id omikuji_agent-JkUdnzGA2D \
  --query 'roleArn' --output text

# æ›´æ–°æ™‚ã« --role-arn ã‚’è¿½åŠ 
aws bedrock-agentcore-control update-agent-runtime \
  --agent-runtime-id omikuji_agent-JkUdnzGA2D \
  --agent-runtime-artifact 'containerConfiguration={containerUri=xxx}' \
  --network-configuration networkMode=PUBLIC \
  --role-arn arn:aws:iam::<ACCOUNT_ID>:role/AmazonBedrockAgentCoreSDKRuntime-...
```

## ç’°å¢ƒå¤‰æ•°

### AgentCore Runtimeï¼ˆomikuji_agent.pyï¼‰

| å¤‰æ•°å | èª¬æ˜ | ä¾‹ |
|--------|------|-----|
| `AWS_REGION` | AWSãƒªãƒ¼ã‚¸ãƒ§ãƒ³ | ap-northeast-1 |
| `BEDROCK_AGENTCORE_MEMORY_ID` | Memory ID | my_agent_mem-W3DiyUCFmg |

### Next.js API Routes

| å¤‰æ•°å | èª¬æ˜ | ä¾‹ |
|--------|------|-----|
| `AGENTCORE_RUNTIME_ARN` | Runtime ARN | arn:aws:bedrock-agentcore:... |
| `AWS_REGION` | AWSãƒªãƒ¼ã‚¸ãƒ§ãƒ³ | ap-northeast-1 |

## ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†è¨­è¨ˆ

### ãŠã¿ãã˜ID = session_id = ãƒãƒ£ãƒƒãƒˆID

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã®è¨­è¨ˆ                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã€‘                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ãŠã¿ãã˜ã‚’å¼•ã â†’ æ–°ã—ã„ session_id ç™ºè¡Œ                          â”‚   â”‚
â”‚  â”‚ ãƒãƒ£ãƒƒãƒˆã™ã‚‹ â†’ åŒã˜ session_id ã‚’ä½¿ç”¨                            â”‚   â”‚
â”‚  â”‚ å†åº¦ãŠã¿ãã˜ â†’ æ–°ã—ã„ session_id ç™ºè¡Œ                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â”‚  ã€session_id å½¢å¼ã€‘                                                    â”‚
â”‚  omikuji-{timestamp}-{uuid8}-{uuid4}  (36æ–‡å­—ä»¥ä¸Šå¿…é ˆ)                 â”‚
â”‚  ä¾‹: omikuji-20251225143052-a1b2c3d4-e5f6                              â”‚
â”‚                                                                         â”‚
â”‚  ã€AgentCore Memoryã€‘                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ session_id ã”ã¨ã«ä¼šè©±å±¥æ­´ã‚’åˆ†é›¢                                  â”‚   â”‚
â”‚  â”‚ - ãŠã¿ãã˜çµæœã‚’è¨˜æ†¶                                             â”‚   â”‚
â”‚  â”‚ - ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã‚’è¨˜æ†¶                                             â”‚   â”‚
â”‚  â”‚ - åˆ¥ã® session_id ã¯åˆ¥ã®ä¼šè©±                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### AgentCoreMemoryConfig ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | å‹ | å¿…é ˆ | èª¬æ˜ |
|-----------|-----|------|------|
| `memory_id` | str | âœ… | AgentCore Memory ID |
| `session_id` | str | âœ… | ãŠã¿ãã˜IDï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ï¼‰ |
| `actor_id` | str | âœ… | ãƒ¦ãƒ¼ã‚¶ãƒ¼è­˜åˆ¥å­ |
| `retrieval_config` | dict | âŒ | æ¤œç´¢è¨­å®šï¼ˆLTMç”¨ï¼‰ |

## ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹

### âœ… å®Œäº†

- [x] AgentCore Runtime ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆomikuji_agent-JkUdnzGA2Dï¼‰
- [x] Strands Agent åŸºæœ¬å®Ÿè£…
- [x] ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ UI å®Œæˆ
- [x] Amplify Hosting ãƒ‡ãƒ—ãƒ­ã‚¤
- [x] ãŠã¿ãã˜æ©Ÿèƒ½ç¨¼åƒ
- [x] ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ç¨¼åƒ
- [x] **Strands + AgentCore Memory çµ±åˆ** âœ¨
  - AgentCoreMemorySessionManager å®Ÿè£…
  - ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã®ä¿®æ­£ï¼ˆ36æ–‡å­—ä»¥ä¸Šã®ã‚»ãƒƒã‚·ãƒ§ãƒ³IDï¼‰
  - ãŠã¿ãã˜/ãƒãƒ£ãƒƒãƒˆåˆ†é›¢ï¼ˆaction ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰
- [x] **CodeBuild GitHub é€£æº** ğŸš€
  - GitHub ãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰ç›´æ¥ãƒ“ãƒ«ãƒ‰ï¼ˆS3 ZIP å»ƒæ­¢ï¼‰
  - å†ç¾æ€§ã®ã‚ã‚‹ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ•ãƒ­ãƒ¼ç¢ºç«‹

### ğŸ“‹ TODO

- [ ] Code Interpreter çµ±åˆï¼ˆçµ±è¨ˆãƒ»ã‚°ãƒ©ãƒ•ç”Ÿæˆï¼‰
- [ ] Long-Term Memory (LTM) å¯¾å¿œ
- [ ] actor_id ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å€‹åˆ¥åŒ–ï¼ˆç¾åœ¨ã¯å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼å…±é€šï¼‰
- [ ] Cognito èªè¨¼é€£æº
- [ ] CloudWatch GenAI Dashboard è¨­å®š

## AgentCore Runtime æƒ…å ±

| é …ç›® | å€¤ |
|------|-----|
| **Runtime Name** | omikuji_agent |
| **Runtime ID** | omikuji_agent-JkUdnzGA2D |
| **Runtime ARN** | arn:aws:bedrock-agentcore:ap-northeast-1:226484346947:runtime/omikuji_agent-JkUdnzGA2D |
| **Role ARN** | arn:aws:iam::226484346947:role/AmazonBedrockAgentCoreSDKRuntime-ap-northeast-1-e72c1a7c7a |
| **Memory ID** | my_agent_mem-W3DiyUCFmg |
| **Status** | READY |
| **ECR Repository** | bedrock-agentcore-my_agent |
| **CodeBuild Project** | bedrock-agentcore-my_agent-builder |

## å‚è€ƒãƒªãƒ³ã‚¯

### AWS å…¬å¼

- [Amazon Bedrock AgentCore](https://aws.amazon.com/bedrock/agentcore/)
- [AgentCore Memory ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://docs.aws.amazon.com/bedrock-agentcore/latest/devguide/memory.html)
- [Strands SDK Memory çµ±åˆ](https://docs.aws.amazon.com/bedrock-agentcore/latest/devguide/strands-sdk-memory.html)

### Strands Agents

- [Strands Agents å…¬å¼ã‚µã‚¤ãƒˆ](https://strandsagents.com/latest/)
- [AgentCore Memory Session Manager](https://strandsagents.com/latest/documentation/docs/community/session-managers/agentcore-memory/)
- [GitHub: bedrock-agentcore-sdk-python](https://github.com/aws/bedrock-agentcore-sdk-python/)

### ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«

- [AWS re:Invent 2025 - Build observable AI agents with Strands](https://www.youtube.com/watch?v=RQfW7eQsXqk)
- [Making AI Agents Remember: Amazon Bedrock Agent Core Memory](https://dev.to/aws/bring-ai-agents-with-long-term-memory-into-production-in-minutes-338l)

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License

## ä½œè€…

Made with ğŸ’• and Strands Agents ğŸ§µ

---

**æœ¬ç•ªã‚µã‚¤ãƒˆ**: https://main.d41aq4729k4l7.amplifyapp.com

**2025.12 å¯¾å¿œç‰ˆ** - Strands Agents + AgentCore Memory çµ±åˆæ§‹æˆ
